CREATE VIEW `pdp_latest` AS
(select `a`.`id` AS `id`,`a`.`committee` AS `committee`,`a`.`creator` AS `creator`,`a`.`removed` AS `removed`,`c`.`pdp_id` AS `pdp_id`,`c`.`version_id` AS `version_id`,`c`.`start` AS `start`,`c`.`end` AS `end`,`c`.`sensitive` AS `sensitive`,`c`.`target_group` AS `target_group`,`c`.`last_changed` AS `last_changed`
from ((`keepit`.`pdps` `a`
join `keepit`.`pdp_versions` `c` on(`a`.`id` = `c`.`pdp_id`))
join (select `keepit`.`pdp_versions`.`pdp_id` AS `pdp_id`,max(`keepit`.`pdp_versions`.`version_id`)
AS `latest` from `keepit`.`pdp_versions` group by `keepit`.`pdp_versions`.`pdp_id`) `b` on(`c`.`pdp_id` = `b`.`pdp_id` and `c`.`version_id` = `b`.`latest`)))